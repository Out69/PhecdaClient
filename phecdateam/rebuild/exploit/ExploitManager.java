package pl.oucik.phecdateam.rebuild.exploit;

import java.util.Arrays;
import java.util.List;
import java.util.Optional;

public class ExploitManager {

  private final List<Exploit<?>> exploits;

  public ExploitManager(Exploit<?>... exploits) {
    this.exploits = Arrays.asList(exploits);
  }

  public Optional<Exploit<?>> getExploit(String name) {
    return exploits.stream()
        .filter(exploit -> exploit.getName().equalsIgnoreCase(name))
        .findFirst();
  }


  public Optional<Exploit<?>> getExploit(String name, ExploitType type) {
    return exploits.stream()
        .filter(exploit -> exploit.getName().equalsIgnoreCase(name))
        .filter(exploit -> exploit.getType() == type)
        .findFirst();
  }

  public void registerExploit(Exploit<?> exploit) {
    exploits.add(exploit);
  }

  public void registerExploits(Exploit<?>... exploits) {
    this.exploits.addAll(Arrays.asList(exploits));
  }

  public void unregisterExploit(Exploit<?> exploit) {
    exploits.remove(exploit);
  }

  public void unregisterExploits(Exploit<?>... exploits) {
    this.exploits.removeAll(Arrays.asList(exploits));
  }

  public List<Exploit<?>> getExploits() {
    return exploits;
  }
}
